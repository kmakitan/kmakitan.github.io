<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
    <style>
    body {
        font: 11px sans-serif;
    }
    
    .axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }
    
    .dot {
        opacity: 0.1;
    }
    
    .title {
        display: inline-block;
        width: 750px;
    }
    </style>
</head>

<body>
    <div>
        <select id="selection" onchange="this.form.submit()">
            <option value="null">Select an option</option>
            <option value="fixed acidity">fixed acidity</option>
            <option value="volatile acidity">volatile acidity</option>
            <option value="citric acid">citric acid</option>
            <option value="residual sugar">residual sugar</option>
            <option value="chlorides">chlorides</option>
            <option value="free sulfur dioxide">free sulfur dioxide</option>
            <option value="total sulfur dioxide">total sulfur dioxide</option>
            <option value="density">density</option>
            <option value="pH">pH</option>
            <option value="sulphates">sulphates</option>
            <option value="alcohol">alcohol</option>
        </select>
    </div>
    <div class="title">
        <p>Red Wine</p>
    </div>
    <div class="title">
        <p>White Wine</p>
    </div>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script>
    selection.onchange = function() {
        d3.selectAll("svg").remove();

        //select getter
        var e = document.getElementById("selection");
        var selected = e.options[e.selectedIndex].value;




        var margin = {
                top: 20,
                right: 20,
                bottom: 30,
                left: 40
            },
            width = 750 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

        // setup x 
        var xValue = function(d) {
                return d[selected];
            }, // data -> value
            xScale = d3.scale.linear().range([0, width]), // value -> display
            xMap = function(d) {
                return xScale(xValue(d));
            }, // data -> display
            xAxis = d3.svg.axis().scale(xScale).orient("bottom");

        // setup y
        var yValue = function(d) {
                return d["quality"];
            }, // data -> value
            yScale = d3.scale.linear().range([height, 0]), // value -> display
            yMap = function(d) {
                return yScale(yValue(d));
            }, // data -> display
            yAxis = d3.svg.axis().scale(yScale).orient("left");

        // add the graph canvas to the body of the webpage  
        var svg = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // load data
        d3.csv("d3/csv/winequality-red.csv", function(data) {

            // change string (from CSV) into number format
            data.forEach(function(d) {
                d[selected] = +d[selected];
                d["quality"] = +d["quality"];
                console.log(d["quality"]);
            });

            // don't want dots overlapping axis, so add in buffer to data domain
            xScale.domain([d3.min(data, xValue) - 0.5, d3.max(data, xValue) + 0.5]);
            yScale.domain([d3.min(data, yValue) - 0.5, d3.max(data, yValue) + 0.5]);

            // x-axis
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis)
                .append("text")
                .attr("class", "label")
                .attr("x", width)
                .attr("y", -6)
                .style("text-anchor", "end")
                .text(selected);

            // y-axis
            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis)
                .append("text")
                .attr("class", "label")
                .attr("transform", "rotate(-90)")
                .attr("y", -6)
                .attr("dy", ".71em")
                .style("text-anchor", "end")
                .text("quality");

            // draw dots
            svg.selectAll(".dot")
                .data(data)
                .enter().append("circle")
                .attr("class", "dot")
                .attr("r", 3.5)
                .attr("cx", function(d) {
                    return xScale(d[selected]);
                })
                .attr("cy", function(d) {
                    return yScale(d["quality"]);
                })
                .style("fill", "red")
        });

        //add second graph--------------------------------------------------------------
        var svg2 = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        d3.csv("d3/csv/winequality-white.csv", function(error, data) {

            // change string (from CSV) into number format
            data.forEach(function(d) {
                d[selected] = +d[selected];
                d["quality"] = +d["quality"];
                //    console.log(d);
            });

            // don't want dots overlapping axis, so add in buffer to data domain
            var padding = (xScale.domain()[1] - xScale.domain()[0]) / 10;
            xScale.domain([d3.min(data, xValue) - padding, d3.max(data, xValue) + padding]);
            yScale.domain([d3.min(data, yValue) - 1, d3.max(data, yValue) + 1]);

            // x-axis
            svg2.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis)
                .append("text")
                .attr("class", "label")
                .attr("x", width)
                .attr("y", -6)
                .style("text-anchor", "end")
                .text(selected);

            // y-axis
            svg2.append("g")
                .attr("class", "y axis")
                .call(yAxis)
                .append("text")
                .attr("class", "label")
                .attr("transform", "rotate(-90)")
                .attr("y", -6)
                .attr("dy", ".71em")
                .style("text-anchor", "end")
                .text("quality");

            // draw dots
            svg2.selectAll(".dot")
                .data(data)
                .enter().append("circle")
                .attr("class", "dot")
                .attr("r", 3.5)
                .attr("cx", function(d) {
                    return xScale(d[selected]);
                })
                .attr("cy", function(d) {
                    return yScale(d["quality"]);
                })
                .style("fill", "blue")
        });

    };
    </script>
</body>
</html>
